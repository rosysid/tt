<!DOCTYPE html>
<html>
<head>
<title>drive api</title>
<meta charset='utf-8'/>
</head>
<body>
<p>DRIVE</p>

  <button id="authorize_button" style="display:none;">Authorize</button>
  <button id="signout_button" style="display:none;">signout</button>
  
  <pre id="content" style="white-space:pre-wrap;"></pre>
  
  <script type="text/javascript">
       var CLIENT_ID="1027812663093-ms3m0iqfthvkej514s3a0ce101imbg2b.apps.googleusercontent.com";
       var API_KEY="AIzaSyApVwlRim3YDuK3CgVkMtcelwc4OwwKN74";
       var DISCOVERY_DOCS=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];
       var SCOPES='https://www.googleapis.com/auth/drive.metadata.readonly';
       
       var authorizeButton=document.getElementById('authorize_button');
       var signoutButton=document.getElementById('signout_button');
       /**
       *on load is called to load the auth2library and api client
       */
       
       function handleClientLoad(){
                    gapi.load('client:auth2',initClient);
                    }
                    
               function initClient(){
                   gapi.client.init({
                   apiKey:API_KEY,
                   clientId:CLIENT_ID,
                   discoveryDocs:DISCOVERY_DOCS,
                   scope:SCOPES }).then(function() {
                      //listen for signin state changes
                      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
 updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
 authorizeButton.onclick=handleAuthClick;
 signoutButton.onClick=handleSignoutClick;
 },function(error){
      appendPre(JSON.stringify(error,null,2));
      });
      }
      
      function updateSigninStatus(isSignedIn){
      if(isSignedIn){
        authorizeButton.style.display='none';
        signoutButton.style.display='block';
        listFiles();}else{
                        authorizeButton.style.display='block';
                        signoutButton.style.display='none';}
                        }
                        
         function handleAuthClick(event){
         gapi.auth2.getAuthInstance().signIn();
         }
         
         function handleSignoutClick(event){
                    gapi.auth2.getAuthInstance().signOut();
                    }
               
               function appendPre(message){
               var pre =document.getElementById('content');
               var textContent=document.createTextNode(message+'\n');
               pre.appendChild(textContent);}
               
               function listFiles(){
                 gapi.client.drive.files.list({
                 'pageSize':10,
                 'fields':"nextPageToken,files(id,name)"
                 }).then(function(response){
                 appendPre('Files:');
                 var files=responce.result.files;
                 if(files && files.length>0){
                 for(var i=0;i<files.length;i++){
                 var file=files[i];
                 appendPre(file.name+'('+file.id+')');
                 }
                 }else{
                 appendPre('No files found');
                 }
                 });
                 }
                 </script>
                 
                 <script async defer src="https://apis.google.com/js/api.js"
                 onload="this.onload=function(){};handleClientLoad()"
                 onreadystatechange="if(this.readyState==='complete') this.onload()">
                 </script>
                 </body>
                 </html>                     
                           
                             
